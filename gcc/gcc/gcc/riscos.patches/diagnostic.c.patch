--- /home/nick/riscos/masters/gcc-3.4/gcc/diagnostic.c	2003-09-22 06:09:12.000000000 +0100
+++ diagnostic.c	2004-06-18 16:27:22.227060560 +0100
@@ -355,7 +355,24 @@ diagnostic_report_diagnostic (diagnostic
     {
       (*diagnostic_starter (context)) (context, diagnostic);
       pp_format_text (context->printer, &diagnostic->message);
+
+#ifdef ERROR_THROWBACK
+      {
+	const char *s;
+
+	/* pp_base_format_verbatim (context->printer, &diagnostic->message); */
+	s = pp_formatted_text (context->printer);
+	/* printf ("throwback = '%s'\n", s); */
+	ERROR_THROWBACK (diagnostic->location.file,
+			 diagnostic->location.line,
+			 (diagnostic->kind == DK_WARNING) ? "warning" : NULL,
+			 s);
+	/* free (s); */
+      }
+#endif
+
       (*diagnostic_finalizer (context)) (context, diagnostic);
+
       pp_flush (context->printer);
       diagnostic_action_after_output (context, diagnostic);
     }
