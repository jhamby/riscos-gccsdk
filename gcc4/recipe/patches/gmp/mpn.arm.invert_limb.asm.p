--- mpn/arm/invert_limb.asm.orig	2011-12-24 15:43:46.692671544 +0100
+++ mpn/arm/invert_limb.asm	2011-12-24 15:43:38.168778703 +0100
@@ -1,6 +1,6 @@
 dnl  ARM mpn_invert_limb -- Invert a normalized limb.
 
-dnl  Copyright 2001, 2009 Free Software Foundation, Inc.
+dnl  Copyright 2001, 2009, 2011 Free Software Foundation, Inc.
 
 dnl  This file is part of the GNU MP Library.
 
@@ -25,62 +25,62 @@ PROLOGUE(mpn_invert_limb)
 L(2):	add	r2, pc, r2
 	mov	r3, r0, lsr #23
 	mov	r3, r3, asl #1
-	ldrh	r3, [r3, r2]
+	ldr	r3, [r2, r3, asl #1]
 	mov	r1, r3, asl #17
-	mul	r3, r3, r3
-	umull	r12, r2, r3, r0
+	mul	r12, r3, r3
+	umull	r3, r2, r12, r0
 	sub	r1, r1, r2, asl #1
-	umull	r12, r2, r1, r1
-	umull	r3, r12, r0, r12
-	umull	r2, r3, r0, r2
-	adds	r2, r2, r12
-	adc	r3, r3, #0
-	rsb	r1, r3, r1
+	umull	r3, r2, r1, r1
+	umull	r12, r3, r0, r3
+	umull	r2, r12, r0, r2
+	adds	r2, r2, r3
+	adc	r12, r12, #0
+	rsb	r1, r12, r1
 	mvn	r2, r2, lsr #30
 	add	r2, r2, r1, asl #2
-	umull	r3, r12, r0, r2
-	adds	r1, r3, r0
-	adc	r12, r12, r0
-	rsb	r0, r12, r2
-	bx	lr
+	umull	r12, r3, r0, r2
+	adds	r1, r12, r0
+	adc	r3, r3, r0
+	rsb	r0, r3, r2
+	mov	pc, r14
 
 	ALIGN(4)
-L(4):	.word	approx_tab-8-512-L(2)
+L(4):	.word	approx_tab-8-1024-L(2)
 EPILOGUE()
 
 	.section .rodata
 	ALIGN(2)
 approx_tab:
-	.short    0xffc0,0xfec0,0xfdc0,0xfcc0,0xfbc0,0xfac0,0xfa00,0xf900
-	.short    0xf800,0xf700,0xf640,0xf540,0xf440,0xf380,0xf280,0xf180
-	.short    0xf0c0,0xefc0,0xef00,0xee00,0xed40,0xec40,0xeb80,0xeac0
-	.short    0xe9c0,0xe900,0xe840,0xe740,0xe680,0xe5c0,0xe500,0xe400
-	.short    0xe340,0xe280,0xe1c0,0xe100,0xe040,0xdf80,0xdec0,0xde00
-	.short    0xdd40,0xdc80,0xdbc0,0xdb00,0xda40,0xd980,0xd8c0,0xd800
-	.short    0xd740,0xd680,0xd600,0xd540,0xd480,0xd3c0,0xd340,0xd280
-	.short    0xd1c0,0xd140,0xd080,0xcfc0,0xcf40,0xce80,0xcdc0,0xcd40
-	.short    0xcc80,0xcc00,0xcb40,0xcac0,0xca00,0xc980,0xc8c0,0xc840
-	.short    0xc780,0xc700,0xc640,0xc5c0,0xc540,0xc480,0xc400,0xc380
-	.short    0xc2c0,0xc240,0xc1c0,0xc100,0xc080,0xc000,0xbf80,0xbec0
-	.short    0xbe40,0xbdc0,0xbd40,0xbc80,0xbc00,0xbb80,0xbb00,0xba80
-	.short    0xba00,0xb980,0xb900,0xb840,0xb7c0,0xb740,0xb6c0,0xb640
-	.short    0xb5c0,0xb540,0xb4c0,0xb440,0xb3c0,0xb340,0xb2c0,0xb240
-	.short    0xb1c0,0xb140,0xb0c0,0xb080,0xb000,0xaf80,0xaf00,0xae80
-	.short    0xae00,0xad80,0xad40,0xacc0,0xac40,0xabc0,0xab40,0xaac0
-	.short    0xaa80,0xaa00,0xa980,0xa900,0xa8c0,0xa840,0xa7c0,0xa740
-	.short    0xa700,0xa680,0xa600,0xa5c0,0xa540,0xa4c0,0xa480,0xa400
-	.short    0xa380,0xa340,0xa2c0,0xa240,0xa200,0xa180,0xa140,0xa0c0
-	.short    0xa080,0xa000,0x9f80,0x9f40,0x9ec0,0x9e80,0x9e00,0x9dc0
-	.short    0x9d40,0x9d00,0x9c80,0x9c40,0x9bc0,0x9b80,0x9b00,0x9ac0
-	.short    0x9a40,0x9a00,0x9980,0x9940,0x98c0,0x9880,0x9840,0x97c0
-	.short    0x9780,0x9700,0x96c0,0x9680,0x9600,0x95c0,0x9580,0x9500
-	.short    0x94c0,0x9440,0x9400,0x93c0,0x9340,0x9300,0x92c0,0x9240
-	.short    0x9200,0x91c0,0x9180,0x9100,0x90c0,0x9080,0x9000,0x8fc0
-	.short    0x8f80,0x8f40,0x8ec0,0x8e80,0x8e40,0x8e00,0x8d80,0x8d40
-	.short    0x8d00,0x8cc0,0x8c80,0x8c00,0x8bc0,0x8b80,0x8b40,0x8b00
-	.short    0x8a80,0x8a40,0x8a00,0x89c0,0x8980,0x8940,0x88c0,0x8880
-	.short    0x8840,0x8800,0x87c0,0x8780,0x8740,0x8700,0x8680,0x8640
-	.short    0x8600,0x85c0,0x8580,0x8540,0x8500,0x84c0,0x8480,0x8440
-	.short    0x8400,0x8380,0x8340,0x8300,0x82c0,0x8280,0x8240,0x8200
-	.short    0x81c0,0x8180,0x8140,0x8100,0x80c0,0x8080,0x8040,0x8000
+	.word    0xffffffc0,0xfffffec0,0xfffffdc0,0xfffffcc0,0xfffffbc0,0xfffffac0,0xfffffa00,0xfffff900
+	.word    0xfffff800,0xfffff700,0xfffff640,0xfffff540,0xfffff440,0xfffff380,0xfffff280,0xfffff180
+	.word    0xfffff0c0,0xffffefc0,0xffffef00,0xffffee00,0xffffed40,0xffffec40,0xffffeb80,0xffffeac0
+	.word    0xffffe9c0,0xffffe900,0xffffe840,0xffffe740,0xffffe680,0xffffe5c0,0xffffe500,0xffffe400
+	.word    0xffffe340,0xffffe280,0xffffe1c0,0xffffe100,0xffffe040,0xffffdf80,0xffffdec0,0xffffde00
+	.word    0xffffdd40,0xffffdc80,0xffffdbc0,0xffffdb00,0xffffda40,0xffffd980,0xffffd8c0,0xffffd800
+	.word    0xffffd740,0xffffd680,0xffffd600,0xffffd540,0xffffd480,0xffffd3c0,0xffffd340,0xffffd280
+	.word    0xffffd1c0,0xffffd140,0xffffd080,0xffffcfc0,0xffffcf40,0xffffce80,0xffffcdc0,0xffffcd40
+	.word    0xffffcc80,0xffffcc00,0xffffcb40,0xffffcac0,0xffffca00,0xffffc980,0xffffc8c0,0xffffc840
+	.word    0xffffc780,0xffffc700,0xffffc640,0xffffc5c0,0xffffc540,0xffffc480,0xffffc400,0xffffc380
+	.word    0xffffc2c0,0xffffc240,0xffffc1c0,0xffffc100,0xffffc080,0xffffc000,0xffffbf80,0xffffbec0
+	.word    0xffffbe40,0xffffbdc0,0xffffbd40,0xffffbc80,0xffffbc00,0xffffbb80,0xffffbb00,0xffffba80
+	.word    0xffffba00,0xffffb980,0xffffb900,0xffffb840,0xffffb7c0,0xffffb740,0xffffb6c0,0xffffb640
+	.word    0xffffb5c0,0xffffb540,0xffffb4c0,0xffffb440,0xffffb3c0,0xffffb340,0xffffb2c0,0xffffb240
+	.word    0xffffb1c0,0xffffb140,0xffffb0c0,0xffffb080,0xffffb000,0xffffaf80,0xffffaf00,0xffffae80
+	.word    0xffffae00,0xffffad80,0xffffad40,0xffffacc0,0xffffac40,0xffffabc0,0xffffab40,0xffffaac0
+	.word    0xffffaa80,0xffffaa00,0xffffa980,0xffffa900,0xffffa8c0,0xffffa840,0xffffa7c0,0xffffa740
+	.word    0xffffa700,0xffffa680,0xffffa600,0xffffa5c0,0xffffa540,0xffffa4c0,0xffffa480,0xffffa400
+	.word    0xffffa380,0xffffa340,0xffffa2c0,0xffffa240,0xffffa200,0xffffa180,0xffffa140,0xffffa0c0
+	.word    0xffffa080,0xffffa000,0xffff9f80,0xffff9f40,0xffff9ec0,0xffff9e80,0xffff9e00,0xffff9dc0
+	.word    0xffff9d40,0xffff9d00,0xffff9c80,0xffff9c40,0xffff9bc0,0xffff9b80,0xffff9b00,0xffff9ac0
+	.word    0xffff9a40,0xffff9a00,0xffff9980,0xffff9940,0xffff98c0,0xffff9880,0xffff9840,0xffff97c0
+	.word    0xffff9780,0xffff9700,0xffff96c0,0xffff9680,0xffff9600,0xffff95c0,0xffff9580,0xffff9500
+	.word    0xffff94c0,0xffff9440,0xffff9400,0xffff93c0,0xffff9340,0xffff9300,0xffff92c0,0xffff9240
+	.word    0xffff9200,0xffff91c0,0xffff9180,0xffff9100,0xffff90c0,0xffff9080,0xffff9000,0xffff8fc0
+	.word    0xffff8f80,0xffff8f40,0xffff8ec0,0xffff8e80,0xffff8e40,0xffff8e00,0xffff8d80,0xffff8d40
+	.word    0xffff8d00,0xffff8cc0,0xffff8c80,0xffff8c00,0xffff8bc0,0xffff8b80,0xffff8b40,0xffff8b00
+	.word    0xffff8a80,0xffff8a40,0xffff8a00,0xffff89c0,0xffff8980,0xffff8940,0xffff88c0,0xffff8880
+	.word    0xffff8840,0xffff8800,0xffff87c0,0xffff8780,0xffff8740,0xffff8700,0xffff8680,0xffff8640
+	.word    0xffff8600,0xffff85c0,0xffff8580,0xffff8540,0xffff8500,0xffff84c0,0xffff8480,0xffff8440
+	.word    0xffff8400,0xffff8380,0xffff8340,0xffff8300,0xffff82c0,0xffff8280,0xffff8240,0xffff8200
+	.word    0xffff81c0,0xffff8180,0xffff8140,0xffff8100,0xffff80c0,0xffff8080,0xffff8040,0xffff8000
 ASM_END()
