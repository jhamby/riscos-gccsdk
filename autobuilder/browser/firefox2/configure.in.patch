Index: configure.in
===================================================================
RCS file: /cvsroot/mozilla/configure.in,v
retrieving revision 1.1503.2.111
diff -u -r1.1503.2.111 configure.in
--- configure.in	26 Mar 2008 19:03:05 -0000	1.1503.2.111
+++ configure.in	12 Aug 2008 04:52:15 -0000
@@ -1403,6 +1403,20 @@
     HOST_OPTIMIZE_FLAGS="${HOST_OPTIMIZE_FLAGS=-O2}"
     ;;
 
+*riscos*)
+    HOST_CFLAGS="$HOST_CFLAGS -DXP_UNIX"
+    HOST_OPTIMIZE_FLAGS="${HOST_OPTIMIZE_FLAGS=-O2}"
+    #DSO_PIC_CFLAGS=
+    #DSO_LDOPTS=
+    #DLL_SUFFIX=.a
+    BIN_SUFFIX=,e1f
+    #MKSHLIB="$AR rc \$@"
+    #MKCSHLIB="$AR rc \$@"
+    #MKSHLIB_FORCE_ALL=''
+    #MKSHLIB_UNFORCE_ALL=''
+    #MOZ_OPTIMIZE_FLAGS=-O2
+    ;;
+
 *)
     HOST_CFLAGS="$HOST_CFLAGS -DXP_UNIX"
     HOST_OPTIMIZE_FLAGS="${HOST_OPTIMIZE_FLAGS=-O2}"
@@ -2791,11 +2805,11 @@
     AC_DEFINE(NO_X11)
 else
     AC_DEFINE_UNQUOTED(FUNCPROTO,15)
-	XLIBS="-lX11 $XLIBS"
+	XLIBS="-lCX11 -lDesk $XLIBS"
 	_SAVE_LDFLAGS="$LDFLAGS"
 	LDFLAGS="$XLDFLAGS $LDFLAGS"
-	AC_CHECK_LIB(X11, XDrawLines, [X11_LIBS="-lX11"],
-		[MISSING_X="$MISSING_X -lX11"], $XLIBS)
+	AC_CHECK_LIB(CX11, XDrawLines, [X11_LIBS=""],
+		[MISSING_X="$MISSING_X "], $XLIBS)
 	AC_CHECK_LIB(Xext, XextAddDisplay, [XEXT_LIBS="-lXext"],
 		[MISSING_X="$MISSING_X -lXext"], $XLIBS)
    
@@ -3961,7 +3975,8 @@
         -o "$_DEFAULT_TOOLKIT" = "windows" \
         -o "$_DEFAULT_TOOLKIT" = "cocoa" \
         -o "$_DEFAULT_TOOLKIT" = "cairo-gtk2" \
-        -o "$_DEFAULT_TOOLKIT" = "cairo-xlib"
+        -o "$_DEFAULT_TOOLKIT" = "cairo-xlib" \
+        -o "$_DEFAULT_TOOLKIT" = "riscos" 
     then
         dnl nglayout only supports building with one toolkit,
         dnl so ignore everything after the first comma (",").
@@ -4062,6 +4077,19 @@
 	TK_LIBS='$(MOZ_XLIB_LDFLAGS) $(MOZ_CAIRO_LIBS)'
 	AC_DEFINE(MOZ_WIDGET_XLIB)
     ;;
+
+riscos)
+    MOZ_ENABLE_RISCOS=1
+    if test "$_HAVE_FREETYPE2"; then
+        MOZ_ENABLE_FREETYPE2=1
+    fi
+    MOZ_ENABLE_XPRINT=1
+    TK_CFLAGS='$(MOZ_XLIB_CFLAGS)'
+    TK_LIBS='$(MOZ_XLIB_LDFLAGS)'
+    AC_DEFINE(MOZ_WIDGET_RISCOS)
+    AC_DEFINE(XP_RISCOS)
+    ;;
+
 esac
 
 if test "$MOZ_ENABLE_XREMOTE"; then
@@ -4083,13 +4111,14 @@
     PKG_CHECK_MODULES(MOZ_GTK2, gtk+-2.0 >= 1.3.7)
 fi
 
-if test "$MOZ_ENABLE_XLIB"
+if test "$MOZ_ENABLE_XLIB" -o "$MOZ_ENABLE_RISCOS"
 then
     MOZ_XLIB_CFLAGS="$X_CFLAGS"
     MOZ_XLIB_LDFLAGS="$XLDFLAGS"
     MOZ_XLIB_LDFLAGS="$MOZ_XLIB_LDFLAGS $XEXT_LIBS $X11_LIBS"
 fi
 
+
 if test "$MOZ_ENABLE_QT"
 then
     MOZ_ARG_WITH_STRING(qtdir,
@@ -4188,7 +4217,8 @@
 if test "$MOZ_ENABLE_GTK" \
 || test "$MOZ_ENABLE_QT" \
 || test "$MOZ_ENABLE_XLIB" \
-|| test "$MOZ_ENABLE_GTK2"
+|| test "$MOZ_ENABLE_GTK2" \
+|| test "$MOZ_ENABLE_RISCOS"
 then
     AC_DEFINE(MOZ_X11)
     MOZ_X11=1
