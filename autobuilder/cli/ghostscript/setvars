AB_URL=http://ghostscript.com/releases/ghostscript-8.64.tar.bz2

# Get Ghostscript fonts:
if [ ! -e fonts/ghostscript-fonts-std-6.0.tar.gz ] ; then
  mkdir -p fonts
  wget -nv -O fonts/ghostscript-fonts-std-6.0.tar.gz ftp://mirror.cs.wisc.edu/pub/mirrors/ghost/fonts/ghostscript-fonts-std-6.0.tar.gz
fi
if [ ! -e fonts/ghostscript-fonts-other-6.0.tar.gz ] ; then
  mkdir -p fonts
  wget -nv -O fonts/ghostscript-fonts-other-6.0.tar.gz ftp://mirror.cs.wisc.edu/pub/mirrors/ghost/fonts/ghostscript-fonts-other-6.0.tar.gz
fi

# Copy src code sprite and gdi device:
cp $H/gdevspr.c src
cp $H/gdevgdi.c src

# Generate makefiles (including Makefile.in)
rm -f configure.ac Makefile.in
ln -s base/configure.ac .
ln -s base/Makefile.in .
autoconf

ab_package () {
  ab_create_app GhostScr Apps/Graphics
  ab_makerun $S/bin/gs$AB_EXEEXT

  cp $S/LICENSE $A

  mkdir -p $AB/8_64
  cp -r $S/doc $A/8_64
  cp -r $S/Resource $A/8_64
  cp -r $S/lib $A/8_64
  rm $A/8_64/lib/*.bat
  rm $A/8_64/lib/*.pl
  ( cd $A ; tar -xzf $S/fonts/ghostscript-fonts-std-6.0.tar.gz )
  ( cd $A ; tar -xzf $S/fonts/ghostscript-fonts-other-6.0.tar.gz )
}
