Index: nsprpub/configure.in
===================================================================
RCS file: /cvsroot/mozilla/nsprpub/configure.in,v
retrieving revision 1.199.2.14
diff -u -r1.199.2.14 configure.in
--- nsprpub/configure.in	27 Apr 2007 20:01:01 -0000	1.199.2.14
+++ nsprpub/configure.in	25 Nov 2007 19:51:20 -0000
@@ -629,6 +629,7 @@
         linux*)       OS_ARCH=Linux ;;
         solaris*)     OS_ARCH=SunOS OS_RELEASE=5 ;;
         mingw*)       OS_ARCH=WINNT ;;
+        riscos*)      OS_ARCH=RISCOS ;;
         darwin*)      OS_ARCH=Darwin ;;
     esac
 else
@@ -1794,13 +1795,14 @@
 
 *-riscos*)
     AC_DEFINE(XP_UNIX)
+    AC_DEFINE(XP_RISCOS)
     AC_DEFINE(RISCOS)
     AC_DEFINE(_PR_NEED_H_ERRNO)
     USE_PTHREADS=1
     MDCPUCFG_H=_riscos.cfg
     PR_MD_CSRCS=riscos.c
     DLL_SUFFIX=a
-    LD="/home/riscos/env/ro-ar cr"
+    LD="$GCCSDK_INSTALL_ENV/ro-ar cr"
     ;;
 
 *-*-sco*)
Index: nsprpub/pr/src/malloc/prmem.c
===================================================================
RCS file: /cvsroot/mozilla/nsprpub/pr/src/malloc/prmem.c,v
retrieving revision 3.19
diff -u -r3.19 prmem.c
--- nsprpub/pr/src/malloc/prmem.c	21 Jul 2005 18:22:53 -0000	3.19
+++ nsprpub/pr/src/malloc/prmem.c	25 Nov 2007 19:51:20 -0000
@@ -150,7 +150,7 @@
     return sym;
 }
 
-#elif defined(USE_MACH_DYLD)
+#elif defined(USE_MACH_DYLD) || defined(RISCOS)
 
 static void *
 pr_FindSymbolInProg(const char *name)
