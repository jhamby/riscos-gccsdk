# Configuration file for CPPUnit under autobuilder
#

AB_CATEGORY=Develop

AB_CONFLAGS="--prefix=`pwd`/cppunit --disable-test-plugin"

AB_INSTALL=yes

ab_package () {
  ROOTDIR=$D/Apps/Library
  mkdir -p $ROOTDIR
  cp -r $H/\!CppUnit $ROOTDIR
  cp -r $S/doc/html $ROOTDIR/\!CppUnit
  cp -r $S/include/cppunit $ROOTDIR/\!CppUnit
  find $ROOTDIR/\!CppUnit/cppunit -name "Makefile*" -exec rm {} \;
  find $ROOTDIR/\!CppUnit/cppunit -noleaf -type d -not -name "h" -exec mkdir {}/h \;
  find $ROOTDIR/\!CppUnit/cppunit -exec rename 's/(.+)\/(.+)\.(.+)/$1\/$3\/$2/' {} \;
  mkdir -p $ROOTDIR/\!CppUnit/a
  cp `pwd`/cppunit/lib/libcppunit.a $ROOTDIR/\!CppUnit/a/libcppunit

  mkdir -p $D/RiscPkg
  cat $H/RiscPkg/Control | sed s/ROVERSION/$AB_ROVERSION/ > $D/RiscPkg/Control
  echo sed "/AUTHORS/ {r $S/AUTHORS d}"
  cat $H/RiscPkg/Copyright | sed "/AUTHORS/ {
                                             r $S/AUTHORS
                                             d
                                            }" > $D/RiscPkg/Copyright
  cat $S/COPYING >> $D/RiscPkg/Copyright
  mkdir -p $D/SysVars
  cp $H/RiscPkg/CppUnit=24* $D/SysVars
}


