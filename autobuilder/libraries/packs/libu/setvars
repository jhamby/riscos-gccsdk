# This package includes the libraries specified
# in the zipprefix file.
# Ideally depends should also be updated to
# ensure the libraries are built before
# being included in this package

AB_NOREMOTE=yes
AB_ZIPNAME=libu-0.1
AB_CATEGORY=libraries

AB_MAKE=":"

ab_package() {
  cp -av $H/\!LibU $D

  FILES=$(cat $H/zipprefix)

  cd $D/\!LibU

  # Get list of libraries
  ls -t -1 $AB_OUTPUTLIB/*.zip > alllibraries

  for FILE in $FILES ; do
     echo "Copying library zip file prefixed $FILE"
     FULLPATH=$( grep -m 1 "$AB_OUTPUTLIB/$FILE" alllibraries )
     echo "Full path found $FULLPATH"
     unzip $FULLPATH
     if [ -e abshortdesc ] ; then
       cat abshortdesc >> $D/\!LibU/\!Help
       rm -f abshortdesc
     fi
  done

  # Need to retype the converted manual files
  echo "Filetypeing man files"
  MANFILES=$(find man -type f)
  for FILE in $MANFILES ; do
     mv $FILE $FILE,faf
  done

  rm -f alllibraries
}
