AB_INSTALL=yes
AB_ROVERSION=2

# Disable smpeg, FLAC and FluidSynth as we don't build them.
AB_CONFLAGS="--disable-music-mod-shared --disable-music-midi-fluidsynth --disable-music-flac --disable-music-mp3 --enable-music-ogg-tremor --disable-music-ogg-shared"

if [ "$RO_SHAREDLIBS" == "yes" ] ; then
AB_PACKAGES="libsdl-mixer1.2-dev libsdl-mixer1.2"
else
AB_PACKAGES="libsdl-mixer1.2-dev"
fi

ab_package() {
  ab_create_app SDLMixer Apps/Library libsdl-mixer1.2-dev

  cd $A

  unzip $AB_OUTPUTLIB/$RO_PKG.zip

  mv include/SDL SDL
  rm -rf include

  mv lib/*.a .
  rm -rf lib

  cd doc
  docdir=`echo *`
  mv $docdir/* .
  rm -rf $docdir

  cp README ../\!Help,feb

  cd $HERE

  cp $S/playwave.c $A/doc
  cp $S/playmus.c $A/doc

  $AB_HOME/add-riscpkg -package libsdl-mixer1.2-dev -unixlib -name LibSDLMixer1.2-Dev -copyrightfile $S/COPYING \
    -depends "Tremor-Dev" -depends "LibSDL1.2-Dev" -depends "LibMikMod-Dev"

  if [ "$RO_SHAREDLIBS" == "yes" ] ; then
     ab_create_sharedlib_skeleton libsdl-mixer1.2
     ab_add_sharedlib $S/.libs libSDL_mixer-1.2.so.0

     $AB_HOME/add-riscpkg -package libsdl-mixer1.2 -name LibSDLMixer1.2 -depends SharedLibs \
		 -name LibSDL1.2 -depends Tremor -depends LibMikmod -section Library \
		 -copyrightfile $H/Copyright
  fi
}

export LIBS='-logg'
